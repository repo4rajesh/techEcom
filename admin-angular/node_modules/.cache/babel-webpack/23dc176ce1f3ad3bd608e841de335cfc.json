{"ast":null,"code":"import { UserAddComponent } from '../add/add.component';\nimport { DeleteConfirmationDialogComponent } from 'src/theme/default/admin/shared/model-popup/delete-confirmation-dialog/delete-confirmation-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../../../../../../../core/admin/settings/user/user.sandbox\";\nimport * as i3 from \"../../../../../../../../../core/admin/settings/user/user.service\";\nimport * as i4 from \"ng6-toastr-notifications\";\nimport * as i5 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../../../../../../shared/components/directives/hide-if-unauthorized.directive\";\nimport * as i9 from \"@angular/material/paginator\";\nimport * as i10 from \"@ngx-translate/core\";\n\nfunction UserListComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"value\", ctx_r0.pageSize);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.pageSize);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"hide-permission\": a0\n  };\n};\n\nfunction UserListComponent_tr_47_a_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"a\", 31);\n    i0.ɵɵlistener(\"click\", function UserListComponent_tr_47_a_12_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const userlist_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.goToPermission(userlist_r2);\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const userlist_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"appHideIfUnauthorized\", \"edit-role-permission\")(\"ngClass\", i0.ɵɵpureFunction1(5, _c0, (userlist_r2 == null ? null : userlist_r2.usergroup == null ? null : userlist_r2.usergroup.groupId) === 1));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 3, \"Settings.Local.Permission\"), \"\");\n  }\n}\n\nconst _c1 = function () {\n  return [\"edit-role-permission\", \"edit-user\", \"delete-user\"];\n};\n\nfunction UserListComponent_tr_47_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵelementStart(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\", 21);\n    i0.ɵɵelementStart(9, \"div\", 25);\n    i0.ɵɵelement(10, \"i\", 26);\n    i0.ɵɵelementStart(11, \"div\", 27);\n    i0.ɵɵtemplate(12, UserListComponent_tr_47_a_12_Template, 3, 7, \"a\", 28);\n    i0.ɵɵelementStart(13, \"a\", 29);\n    i0.ɵɵlistener(\"click\", function UserListComponent_tr_47_Template_a_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const userlist_r2 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.addNewUser(userlist_r2, \"edit\");\n    });\n    i0.ɵɵtext(14);\n    i0.ɵɵpipe(15, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"a\", 30);\n    i0.ɵɵlistener(\"click\", function UserListComponent_tr_47_Template_a_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const userlist_r2 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.deleteUser(userlist_r2.userId);\n    });\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const userlist_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", userlist_r2.firstName, \" \", userlist_r2.lastName, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(userlist_r2.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(userlist_r2.usergroup.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"multipleHide\", i0.ɵɵpureFunction0(14, _c1));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", (ctx_r1.Rolelist == null ? null : ctx_r1.Rolelist.groupId) !== 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"appHideIfUnauthorized\", \"edit-user\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(15, 10, \"Settings.Local.Edit\"), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"appHideIfUnauthorized\", \"delete-user\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(18, 12, \"Settings.Local.Delete\"), \" \");\n  }\n}\n\nconst _c2 = function (a0) {\n  return [a0];\n};\n\nexport let UserListComponent = /*#__PURE__*/(() => {\n  class UserListComponent {\n    constructor(router, sandbox, service, toastr, modalService) {\n      this.router = router;\n      this.sandbox = sandbox;\n      this.service = service;\n      this.toastr = toastr;\n      this.modalService = modalService;\n      this.userdetails = {};\n      this.pageSize = '5';\n      this.keyword = '';\n      this.id = '';\n      this.type = 'edit';\n      this.pagination = 1;\n      this.addnewuser = false;\n      this.subscriptions = [];\n      this.regSubscribeEvents();\n    }\n\n    ngOnInit() {\n      this.pageSize = sessionStorage.getItem('itemsPerPage');\n      this.getUserList(this.offset, this.keyword);\n      this.sandbox.userAddLoaded$.subscribe(data => {\n        if (data === true) {\n          this.getUserList(this.offset, this.keyword);\n        }\n      });\n      this.sandbox.userUpdateLoaded$.subscribe(data => {\n        if (data === true) {\n          this.getUserList(this.offset, this.keyword);\n        }\n      });\n    }\n\n    beforeChange($event) {\n      if ($event.panelId === 'preventchange-2') {\n        $event.preventDefault();\n      }\n\n      if ($event.panelId === 'preventchange-3' && $event.nextState === false) {\n        $event.preventDefault();\n      }\n    }\n\n    addNewUser(data, type) {\n      this.userdetails = null;\n      this.service.setdata(this.userdetails);\n      const modalRef2 = this.modalService.open(UserAddComponent, {\n        windowClass: 'roles',\n        backdrop: 'static',\n        centered: true\n      });\n\n      if (type === 'edit') {\n        this.userdetails = data;\n        this.service.setdata(this.userdetails);\n        modalRef2.componentInstance.edit = this.type;\n        modalRef2.componentInstance.id = data;\n      }\n\n      modalRef2.result.then(result => {\n        if (result === 'close') {}\n      });\n    } // USER LIST\n\n\n    getUserList(offset = 0, keyword) {\n      const params = {};\n      params.limit = this.pageSize;\n      params.offset = offset;\n      params.keyword = this.keyword;\n      this.sandbox.getUserList(params);\n\n      if (this.pagination) {\n        params.count = 'true';\n        this.sandbox.getUserPagination(params);\n      }\n    } // UPDATE USER\n\n\n    editUser(userinfo) {\n      const userDetail = JSON.parse(sessionStorage.getItem('adminUserdetail')).userdetails;\n\n      if (userDetail.userId === userinfo.userId) {\n        this.toastr.errorToastr('You cannot edit current logged in user');\n        return;\n      }\n\n      this.userdetails = userinfo;\n      this.service.setdata(this.userdetails);\n      this.router.navigate(['/settings/user/edit', this.userdetails.userId]);\n    }\n    /**calls getUserList for pagination\n     *\n     * @param event from material paginator\n     * */\n\n\n    onPageChange(event) {\n      this.currentPage = event.offset;\n      this.pageSize = event.pageSize;\n      this.index = event.pageIndex;\n      const offset = event.pageSize * event.pageIndex;\n      this.getUserList(offset, this.pageSize);\n    } // router navigation event to go to permssion page\n\n\n    goToPermission(user) {\n      const userDetail = JSON.parse(sessionStorage.getItem('adminUserdetail')).userdetails;\n\n      if (userDetail.userId === user.userId) {\n        this.toastr.errorToastr('You cannot set permission for current logged in user');\n        return;\n      }\n\n      const details = {\n        id: user.userId,\n        name: user.firstName + ' ' + user.lastName,\n        type: 'user',\n        role: user.usergroup.name\n      };\n      this.router.navigate(['/settings/access-and-permission/permission'], {\n        queryParams: {\n          user: JSON.stringify(details)\n        }\n      });\n    }\n    /**\n     * Handles form 'delete' event. Calls sandbox delete the perticular country.\n     *\n     */\n\n\n    deleteUser(userId) {\n      const modelRef = this.modalService.open(DeleteConfirmationDialogComponent, {\n        size: 'sm',\n        windowClass: 'delete-confirm',\n        backdrop: 'static',\n        backdropClass: 'createcr'\n      });\n      modelRef.componentInstance.key = '';\n      modelRef.componentInstance.id = '';\n      modelRef.result.then(result => {\n        if (result === 'deleted') {\n          const param = {};\n          param.id = userId;\n          this.sandbox.deleteUser(param);\n          this.sandbox.userDelate$.subscribe(_delete => {\n            if (_delete) {\n              if (_delete['status'] === 1) {\n                this.getUserList(this.offset, this.pageSize); // this.(0, this.pageSize);\n              }\n            }\n          });\n        }\n      });\n    } // delete event , subscripe status\n\n\n    regSubscribeEvents() {\n      this.subscriptions.push(this.sandbox.userDelate$.subscribe(_delete => {\n        if (_delete && _delete.status === 1) {\n          this.getUserList(this.offset, '');\n        }\n      }));\n    }\n\n    ngOnDestroy() {\n      this.subscriptions.forEach(each => {\n        each.unsubscribe();\n      });\n    }\n\n  }\n\n  UserListComponent.ɵfac = function UserListComponent_Factory(t) {\n    return new (t || UserListComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UserSandbox), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.ToastrManager), i0.ɵɵdirectiveInject(i5.NgbModal));\n  };\n\n  UserListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserListComponent,\n    selectors: [[\"app-settings-user-list\"]],\n    decls: 51,\n    vars: 33,\n    consts: [[1, \"set-lay-notes\", \"flex\", 2, \"padding\", \"0 10px 10px 10px\"], [1, \"setup-wrapper\", \"set-loc-wrapper\"], [1, \"setup-container\", \"localization-container\"], [1, \"card\", \"ap-general\", \"ap-info\"], [1, \"flex\", \"ap-body\"], [1, \"settings-right-wrapper\"], [1, \"localize-header\", \"flex\"], [1, \"loc-hdr-lft\"], [1, \"input-group\"], [1, \"select\"], [3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"value\", 4, \"ngIf\"], [\"value\", \"10\"], [\"value\", \"20\"], [\"value\", \"30\"], [1, \"set-ad-btn\", 3, \"appHideIfUnauthorized\", \"click\"], [\"src\", \"assets/img/add-white-ico.png\", \"alt\", \"add\"], [1, \"setup-right\"], [1, \"table-responsive\"], [1, \"table\"], [\"width\", \"20%\"], [1, \"text-right\", 3, \"appHideIfUnauthorized\", \"multipleHide\"], [4, \"ngFor\", \"ngForOf\"], [3, \"length\", \"pageSize\", \"pageSizeOptions\", \"page\"], [3, \"value\"], [\"ngbDropdown\", \"\", 1, \"dropdown\"], [\"ngbDropdownToggle\", \"\", 1, \"fa\", \"fa-ellipsis-v\", \"cursor\", 2, \"padding\", \"0 15px\"], [\"ngbDropdownMenu\", \"\", 1, \"dropdown-menu\", 2, \"min-width\", \"88px\"], [\"class\", \"dropdown-item\", \"ngbDropdownItem\", \"\", \"style\", \"cursor: pointer;\", 3, \"appHideIfUnauthorized\", \"ngClass\", \"click\", 4, \"ngIf\"], [\"ngbDropdownItem\", \"\", \"href\", \"javascript:void(0)\", 1, \"dropdown-item\", 3, \"appHideIfUnauthorized\", \"click\"], [1, \"dropdown-item\", 2, \"margin-left\", \"15px\", \"cursor\", \"pointer\", 3, \"appHideIfUnauthorized\", \"click\"], [\"ngbDropdownItem\", \"\", 1, \"dropdown-item\", 2, \"cursor\", \"pointer\", 3, \"appHideIfUnauthorized\", \"ngClass\", \"click\"]],\n    template: function UserListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"h4\");\n        i0.ɵɵtext(2, \"Note :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"p\");\n        i0.ɵɵtext(4, \"The super admin can add different users and assign the users to a particular role. The users will be able to access only those modules to which they are granted the permission to access. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 1);\n        i0.ɵɵelementStart(6, \"div\", 2);\n        i0.ɵɵelementStart(7, \"div\", 3);\n        i0.ɵɵelementStart(8, \"div\", 4);\n        i0.ɵɵelementStart(9, \"div\", 5);\n        i0.ɵɵelementStart(10, \"div\", 6);\n        i0.ɵɵelementStart(11, \"div\", 7);\n        i0.ɵɵelementStart(12, \"div\", 8);\n        i0.ɵɵelementStart(13, \"p\");\n        i0.ɵɵtext(14);\n        i0.ɵɵpipe(15, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 9);\n        i0.ɵɵelementStart(17, \"select\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function UserListComponent_Template_select_ngModelChange_17_listener($event) {\n          return ctx.pageSize = $event;\n        })(\"change\", function UserListComponent_Template_select_change_17_listener() {\n          return ctx.getUserList(0, \"\");\n        });\n        i0.ɵɵtemplate(18, UserListComponent_option_18_Template, 2, 2, \"option\", 11);\n        i0.ɵɵelementStart(19, \"option\", 12);\n        i0.ɵɵtext(20, \"10\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"option\", 13);\n        i0.ɵɵtext(22, \"20\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"option\", 14);\n        i0.ɵɵtext(24, \"30\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function UserListComponent_Template_button_click_25_listener() {\n          return ctx.addNewUser(\"\", \"add\");\n        });\n        i0.ɵɵelement(26, \"img\", 16);\n        i0.ɵɵtext(27);\n        i0.ɵɵpipe(28, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 17);\n        i0.ɵɵelementStart(30, \"div\", 18);\n        i0.ɵɵelementStart(31, \"table\", 19);\n        i0.ɵɵelementStart(32, \"thead\");\n        i0.ɵɵelementStart(33, \"tr\");\n        i0.ɵɵelementStart(34, \"th\", 20);\n        i0.ɵɵtext(35);\n        i0.ɵɵpipe(36, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"th\");\n        i0.ɵɵtext(38);\n        i0.ɵɵpipe(39, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"th\");\n        i0.ɵɵtext(41);\n        i0.ɵɵpipe(42, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"th\", 21);\n        i0.ɵɵtext(44);\n        i0.ɵɵpipe(45, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"tbody\");\n        i0.ɵɵtemplate(47, UserListComponent_tr_47_Template, 19, 15, \"tr\", 22);\n        i0.ɵɵpipe(48, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(49, \"mat-paginator\", 23);\n        i0.ɵɵlistener(\"page\", function UserListComponent_Template_mat_paginator_page_49_listener($event) {\n          return ctx.onPageChange($event);\n        });\n        i0.ɵɵpipe(50, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(14);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(15, 14, \"Settings.Local.Resultsperpage\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.pageSize);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.pageSize !== \"10\" && ctx.pageSize !== \"20\" && ctx.pageSize !== \"30\");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"appHideIfUnauthorized\", \"create-user\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(28, 16, \"Settings.User.AddNewUser\"));\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(36, 18, \"Settings.User.UserName\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(39, 20, \"Settings.User.EmailId\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(42, 22, \"Settings.User.Role\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"multipleHide\", i0.ɵɵpureFunction0(30, _c1));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(45, 24, \"Settings.User.Action\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(48, 26, ctx.sandbox.getUsersList$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"length\", i0.ɵɵpipeBind1(50, 28, ctx.sandbox.userPagination$))(\"pageSize\", ctx.pageSize)(\"pageSizeOptions\", i0.ɵɵpureFunction1(31, _c2, ctx.pageSize));\n      }\n    },\n    directives: [i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgModel, i7.NgIf, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i8.MyHideIfUnauthorizedDirective, i7.NgForOf, i9.MatPaginator, i5.NgbDropdown, i5.NgbDropdownToggle, i5.NgbDropdownMenu, i5.NgbDropdownItem, i7.NgClass],\n    pipes: [i10.TranslatePipe, i7.AsyncPipe],\n    styles: [\".settings-right-wrapper[_ngcontent-%COMP%]{margin-top:0!important}.setting1-inner-header[_ngcontent-%COMP%]{margin-top:40px!important}.coc[_ngcontent-%COMP%]{background:#f20a6d;border:solid thin #dddddd;color:#fff;padding:4px 16px}\"]\n  });\n  return UserListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}